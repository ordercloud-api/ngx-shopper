<div class="container mt-4">
  <div class="row">
    <div class="col-8">
      <h1>Products</h1>
    </div>
    <div class="col-4">
      <button class="btn btn-primary float-right mt-3" (click)="openNewProductModal()">
        <fa-icon [icon]="faPlusCircle"></fa-icon> New Product</button>
      <shared-modal id="{{ modalID }}" modalTitle="Create A New Product - Basic Info">
        <products-form btnText="Save" (formSubmitted)="addProduct($event)"></products-form>
      </shared-modal>
    </div>
  </div>
  <div class="mt-4" *ngIf="products">
    <shared-search class="mt-1" placeholderText="Search products..." (searched)="searchChanged($event)"></shared-search>
    <div *ngIf="products.Meta?.TotalPages > 1" class="my-2 row">
      <div class="col-12">
        <div class="float-right">
          {{ ((products.Meta.Page - 1) * products.Meta.PageSize) + 1 }} - {{ products.Meta.Page * products.Meta.PageSize }} of {{ products.Meta?.TotalCount
          }} results
        </div>
      </div>
    </div>
    <div class="table-responsive">
      <table *ngIf="products.Items.length" class="table table-striped table-bordered mt-3">
        <thead>
          <tr>
            <th>
              <shared-sort-column fieldName="ID" [currentSort]="requestOptions.sortBy" (sort)="sortChanged($event)">ID</shared-sort-column>
            </th>
            <th>
              <shared-sort-column fieldName="Name" [currentSort]="requestOptions.sortBy" (sort)="sortChanged($event)">Name</shared-sort-column>
            </th>
            <th>Active</th>
            <th>Delete</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of products.Items">
            <td>{{product.ID}}</td>
            <td>
              <a [routerLink]="['/products', product.ID]">{{product.Name}}</a>
            </td>
            <td class="text-center">
              <fa-icon aria-hidden="true" [ngClass]="{'text-success': product.Active}" [icon]="faCircle"></fa-icon>
            </td>
            <td>
              <button (click)="deleteProduct(product.ID)" class="btn btn-danger btn-xs">
                <fa-icon [icon]="faTrash"></fa-icon>
                <span class="hidden-xs"> Delete</span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="card bg-light p-3 mx-4 w-100 text-center" *ngIf="products && products.length === 0">
      <p class="mb-0">No products found</p>
    </div>
    <ngb-pagination *ngIf="products.Meta?.TotalPages > 1" class="d-flex justify-content-center" [collectionSize]="products.Meta.TotalCount"
      [pageSize]="products.Meta.PageSize" [(page)]="products.Meta.Page" (pageChange)="pageChanged($event)"></ngb-pagination>
  </div>
</div>